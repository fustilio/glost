# Gender Plugin Guide

## Real-World Use Case: Romance Language Learning App

**Scenario**: You're building a French/Spanish/German learning app. Nouns have grammatical gender (masculine/feminine/neuter) which affects articles, adjectives, and agreement. Students need to learn and practice gender.

## Before (Without Gender Data)

```
French: "le chat" vs "la chat"
Spanish: "el gato" vs "la gata"
German: "der Hund" vs "die Katze" vs "das Haus"

Students memorize each noun's gender individually.
No visual cues or pattern recognition support.
```

## After (With Gender Plugin)

### Sample French Nouns

```typescript
const frenchNouns = [
  "chat",      // cat (masculine)
  "chien",     // dog (masculine)
  "maison",    // house (feminine)
  "voiture",   // car (feminine)
  "livre",     // book (masculine)
  "table",     // table (feminine)
];
```

### With Gender Data (From French Dictionary)

```typescript
import { processGLOSTWithExtensionsAsync } from "glost-plugins";
import { createGenderExtension } from "glost-gender";
import { createFrenchGenderProvider } from "./my-dictionary-provider";

// Real dictionary data
const frenchGenders = new Map([
  ["chat", "masculine"],
  ["chien", "masculine"],
  ["maison", "feminine"],
  ["voiture", "feminine"],
  ["livre", "masculine"],
  ["table", "feminine"],
]);

const provider = createFrenchGenderProvider({ dictionary: frenchGenders });
const [genderGen, genderEnh] = createGenderExtension({
  targetLanguage: "fr",
  provider
});

const result = await processGLOSTWithExtensionsAsync(glostDoc, [genderGen, genderEnh]);
```

### Output (Visualized)

```
ðŸ“˜ le    chat     [Masc] â†’ Masculine (blue)
ðŸ“˜ le    chien    [Masc] â†’ Masculine (blue)
ðŸ“• la    maison   [Fem]  â†’ Feminine  (pink)
ðŸ“• la    voiture  [Fem]  â†’ Feminine  (pink)
ðŸ“˜ le    livre    [Masc] â†’ Masculine (blue)
ðŸ“• la    table    [Fem]  â†’ Feminine  (pink)
```

### UI Implementation

```typescript
function NounWithGender({ word }) {
  const gender = word.extras?.gender;
  
  if (!gender) {
    return <span className="no-gender">{word.text}</span>;
  }
  
  const styles = {
    masculine: { 
      color: "#4A90E2", 
      icon: "â™‚", 
      article: "le/un" 
    },
    feminine: { 
      color: "#E24A90", 
      icon: "â™€", 
      article: "la/une" 
    },
    neuter: { 
      color: "#9B59B6", 
      icon: "âš¬", 
      article: "das/ein" 
    }
  };
  
  const style = styles[gender.type] || styles.masculine;
  
  return (
    <span 
      className={`noun gender-${gender.type}`}
      style={{ 
        borderLeft: `4px solid ${style.color}`,
        paddingLeft: '8px'
      }}
      title={`${gender.display} - use "${style.article}"`}
    >
      <span className="icon">{style.icon}</span>
      {word.text}
    </span>
  );
}
```

## Value Demonstrated

### 1. Article Selection Helper

```typescript
function getCorrectArticle(noun, articleType) {
  const gender = noun.extras?.gender?.type;
  
  const articles = {
    fr: {
      masculine: { definite: "le", indefinite: "un" },
      feminine: { definite: "la", indefinite: "une" }
    },
    es: {
      masculine: { definite: "el", indefinite: "un" },
      feminine: { definite: "la", indefinite: "una" }
    },
    de: {
      masculine: { definite: "der", indefinite: "ein" },
      feminine: { definite: "die", indefinite: "eine" },
      neuter: { definite: "das", indefinite: "ein" }
    }
  };
  
  return articles[noun.lang]?.[gender]?.[articleType];
}

// "chat" (masculine) + definite â†’ "le"
// "maison" (feminine) + indefinite â†’ "une"
```

### 2. Gender Agreement Exercise Generator

```typescript
function generateAgreementExercise(noun, adjective) {
  const gender = noun.extras?.gender?.type;
  
  // French: adjectives often add -e for feminine
  const adjectiveForm = gender === "feminine" 
    ? adjective + "e"  // "petit" â†’ "petite"
    : adjective;       // "petit" stays "petit"
  
  return {
    question: `What is the correct form: "${noun.text}" ___ ?`,
    options: [adjective, adjective + "e"],
    correct: adjectiveForm,
    explanation: `"${noun.text}" is ${gender}, so use "${adjectiveForm}"`
  };
}

// "chat" (masculine) + "petit" â†’ "petit chat" (no -e)
// "maison" (feminine) + "petit" â†’ "petite maison" (add -e)
```

### 3. Pattern Recognition

```typescript
function identifyGenderPatterns(nouns) {
  const byEnding = {};
  
  nouns.forEach(noun => {
    const ending = noun.text.slice(-3); // last 3 letters
    const gender = noun.extras?.gender?.type;
    
    if (!byEnding[ending]) {
      byEnding[ending] = { masculine: 0, feminine: 0 };
    }
    byEnding[ending][gender]++;
  });
  
  // Find patterns
  const patterns = Object.entries(byEnding)
    .filter(([ending, counts]) => {
      const total = counts.masculine + counts.feminine;
      const dominant = Math.max(counts.masculine, counts.feminine);
      return dominant / total > 0.8; // 80%+ correlation
    });
  
  return patterns;
}

// French patterns discovered:
// -tion â†’ 95% feminine ("nation", "station", "action")
// -age â†’ 85% masculine ("garage", "village", "message")
// -eur â†’ 90% masculine ("acteur", "docteur", "professeur")
```

## Real Data Example: German (Three Genders)

### German Gender System

```typescript
const germanGenders = new Map([
  // Masculine
  ["Mann", "masculine"],    // man
  ["Hund", "masculine"],    // dog
  ["Tisch", "masculine"],   // table
  
  // Feminine
  ["Frau", "feminine"],     // woman
  ["Katze", "feminine"],    // cat
  ["Lampe", "feminine"],    // lamp
  
  // Neuter
  ["Kind", "neuter"],       // child
  ["Haus", "neuter"],       // house
  ["Auto", "neuter"],       // car
]);

const germanProvider = createGermanGenderProvider({ 
  dictionary: germanGenders 
});
```

### German Sentence Example

**Text**: "Der Mann und die Frau lesen das Buch"  
(The man and the woman read the book)

**Output with Gender**:
```
Der    [Art-Masc]  â™‚ Masculine article
Mann   [N-Masc]    â™‚ Masculine noun
und    [Conj]      - (and)
die    [Art-Fem]   â™€ Feminine article  
Frau   [N-Fem]     â™€ Feminine noun
lesen  [V]         - (read)
das    [Art-Neut]  âš¬ Neuter article
Buch   [N-Neut]    âš¬ Neuter noun
```

**Pattern Shown**: 
- der + masculine noun (Mann)
- die + feminine noun (Frau)
- das + neuter noun (Buch)

Student learns article-gender agreement!

## Spanish Example: Gender with Plural Forms

### Spanish Gender and Number

```typescript
const spanishNouns = [
  { word: "gato", gender: "masculine", plural: "gatos" },       // cat(s)
  { word: "gata", gender: "feminine", plural: "gatas" },        // cat(s) female
  { word: "libro", gender: "masculine", plural: "libros" },     // book(s)
  { word: "mesa", gender: "feminine", plural: "mesas" },        // table(s)
];
```

### Gender + Number Agreement

```typescript
function getSpanishArticle(noun, number = "singular") {
  const gender = noun.extras?.gender?.type;
  
  const articles = {
    masculine: { singular: "el", plural: "los" },
    feminine: { singular: "la", plural: "las" }
  };
  
  return articles[gender]?.[number];
}

// "gato" + singular â†’ "el gato"
// "gato" + plural â†’ "los gatos"
// "mesa" + singular â†’ "la mesa"
// "mesa" + plural â†’ "las mesas"
```

### Visual Representation

```
Singular:
ðŸ“˜ el   gato   (masculine singular)
ðŸ“• la   mesa   (feminine singular)

Plural:
ðŸ“˜ los  gatos  (masculine plural)
ðŸ“• las  mesas  (feminine plural)

Pattern: Masculine uses el/los, Feminine uses la/las
```

## Practical Applications

### 1. Flashcard Study Mode

```typescript
function createGenderFlashcard(noun) {
  const gender = noun.extras?.gender;
  
  return {
    front: noun.text,                    // "chat"
    back: {
      gender: gender?.display,           // "Masculine"
      article: getCorrectArticle(noun),  // "le"
      example: `${getCorrectArticle(noun)} ${noun.text}`, // "le chat"
      mnemonic: generateMnemonic(noun)   // "Chat sounds like 'shah' - masculine"
    },
    review: {
      question: `What is the gender of "${noun.text}"?`,
      options: ["Masculine", "Feminine", "Neuter"],
      correct: gender?.type
    }
  };
}
```

### 2. Fill-in-the-Blank Exercises

```typescript
function generateArticleExercise(sentence) {
  // Original: "Le chat mange la souris"
  // Remove articles: "___ chat mange ___ souris"
  
  const nouns = extractNouns(sentence);
  const blanks = nouns.map(noun => ({
    word: noun.text,
    gender: noun.extras?.gender?.type,
    correct: getCorrectArticle(noun, "definite")
  }));
  
  return {
    text: sentence.replace(/\b(le|la|les|l')\b/gi, "___"),
    blanks,
    check: (userAnswers) => {
      return userAnswers.map((answer, i) => 
        answer.toLowerCase() === blanks[i].correct.toLowerCase()
      );
    }
  };
}

// Student fills: "_le_ chat mange _la_ souris"
// Instant feedback based on gender data
```

### 3. Gender Consistency Checker

```typescript
function checkGenderAgreement(sentence) {
  const errors = [];
  
  // Check article-noun agreement
  for (let i = 0; i < sentence.words.length - 1; i++) {
    const word = sentence.words[i];
    const next = sentence.words[i + 1];
    
    if (word.pos === "article" && next.pos === "noun") {
      const articleGender = inferArticleGender(word.text);
      const nounGender = next.extras?.gender?.type;
      
      if (articleGender !== nounGender) {
        errors.push({
          position: i,
          error: `Article "${word.text}" (${articleGender}) doesn't match noun "${next.text}" (${nounGender})`,
          suggestion: `Use "${getCorrectArticle(next)}" instead`
        });
      }
    }
  }
  
  return errors;
}

// "la chat" â†’ Error: "la" (feminine) doesn't match "chat" (masculine)
// Suggestion: "Use 'le' instead"
```

## French Ending Patterns (Data-Driven)

### Pattern Discovery

```typescript
// Analyze 10,000 French nouns from dictionary
const frenchNouns = await loadFrenchDictionary();
const patterns = discoverGenderPatterns(frenchNouns);

// Results:
const reliablePatterns = {
  feminine: [
    { ending: "-tion", accuracy: 96%, examples: ["nation", "station", "action"] },
    { ending: "-sion", accuracy: 94%, examples: ["passion", "mission", "vision"] },
    { ending: "-tÃ©", accuracy: 92%, examples: ["libertÃ©", "beautÃ©", "vÃ©ritÃ©"] },
    { ending: "-ette", accuracy: 89%, examples: ["cigarette", "cassette", "tablette"] }
  ],
  masculine: [
    { ending: "-age", accuracy: 85%, examples: ["garage", "village", "fromage"] },
    { ending: "-ment", accuracy: 93%, examples: ["moment", "document", "Ã©lÃ©ment"] },
    { ending: "-eur", accuracy: 88%, examples: ["acteur", "professeur", "docteur"] },
    { ending: "-isme", accuracy: 97%, examples: ["capitalisme", "tourisme", "rÃ©alisme"] }
  ]
};
```

### Teaching Patterns

```typescript
function teachGenderPattern(pattern) {
  const nouns = findNounsWithEnding(pattern.ending);
  
  return {
    rule: `Words ending in "${pattern.ending}" are usually ${pattern.gender}`,
    accuracy: `${pattern.accuracy}% accurate`,
    examples: nouns.slice(0, 5),
    practice: generatePatternExercise(nouns)
  };
}

// "Words ending in '-tion' are usually feminine (96% accurate)"
// Examples: nation â™€, station â™€, action â™€, solution â™€, option â™€
```

## Integration Example: Complete Gender Learning System

```typescript
import { glost } from "glost";
import { createGenderPlugin } from "glost-gender";

// 1. Load gender dictionary
const genderDict = await loadFrenchGenderDictionary();
const provider = createFrenchGenderProvider({ dictionary: genderDict });

// 2. Create and freeze processor for reuse
const processor = glost()
  .use(createGenderPlugin({
    targetLanguage: "fr",
    provider
  }))
  .freeze();

// 3. Process text
const text = "Le chat noir joue avec la souris grise.";
const glostDoc = convertTextToGLOST(text, "fr");
const result = await processor.process(glostDoc);

// 4. Render gender-aware UI
function GenderLearningView({ document }) {
  const nouns = extractNouns(document);
  const patterns = identifyGenderPatterns(nouns);
  
  return (
    <div className="gender-view">
      <div className="text-display">
        {document.children.map(sentence => (
          <SentenceWithGender sentence={sentence} />
        ))}
      </div>
      
      <div className="gender-stats">
        <GenderDistribution nouns={nouns} />
        <PatternHighlights patterns={patterns} />
      </div>
      
      <div className="practice">
        <ArticleExercises nouns={nouns} />
        <GenderQuiz nouns={nouns} />
      </div>
    </div>
  );
}

// 5. Show statistics
function GenderDistribution({ nouns }) {
  const counts = countByGender(nouns);
  
  return (
    <div className="distribution">
      <div className="masculine">
        â™‚ Masculine: {counts.masculine}
        <small>{nouns.filter(n => n.gender === 'masculine').map(n => n.text).join(', ')}</small>
      </div>
      <div className="feminine">
        â™€ Feminine: {counts.feminine}
        <small>{nouns.filter(n => n.gender === 'feminine').map(n => n.text).join(', ')}</small>
      </div>
    </div>
  );
}
```

## Conclusion

Gender data transforms noun learning from **memorization** into **pattern recognition**:

- âœ… Visual cues (colors, icons) reinforce gender
- âœ… Correct articles automatically shown (le vs la, der vs die vs das)
- âœ… Patterns discovered (-tion = feminine, -age = masculine)
- âœ… Agreement errors caught (la chat â†’ le chat)
- âœ… Exercises generated automatically (fill article, match gender)

**The key**: Validated gender data from dictionaries, not guessing from endings (which is only 85-95% accurate at best, and patterns vary by language).

**Note**: The Gender plugin is only applicable to languages with grammatical gender (French, Spanish, German, Russian, etc.). For languages without grammatical gender (English, Thai, Japanese, Chinese), this plugin returns `undefined` for all words.
