# Difficulty Plugin Guide

## Real-World Use Case: Adaptive Learning Platform

**Scenario**: You're building a language learning app that adapts content to student level (beginner, intermediate, advanced). You need to automatically assess text difficulty and recommend appropriate materials.

## Before (Without Difficulty Data)

```
Text A: "I go to school every day."
Text B: "The implementation of the aforementioned protocol requires meticulous attention."

Both texts look similar in the system.
Teacher must manually grade each text.
Students get inappropriate materials.
```

## After (With Difficulty Plugin)

### Sample Texts

```typescript
const texts = [
  {
    id: 1,
    title: "Daily Routine",
    text: "I go to school every day. I study English and math."
  },
  {
    id: 2,
    title: "Science Paper",
    text: "The implementation of the aforementioned protocol requires meticulous attention."
  },
  {
    id: 3,
    title: "News Article",
    text: "The government announced new regulations for environmental protection."
  }
];
```

### With Difficulty Assessment (Based on CEFR Word Lists)

```typescript
import { glost } from "glost";
import { createDifficultyPlugin } from "glost-difficulty";
import { createCEFRDifficultyProvider } from "./my-wordlist-provider";

// Real CEFR word lists
const cefrLists = {
  A1: new Set(["I", "go", "to", "school", "every", "day", "and"]),
  A2: new Set(["study", "English", "math", "new"]),
  B1: new Set(["government", "announced", "regulations"]),
  B2: new Set(["environmental", "protection", "implementation"]),
  C1: new Set(["protocol", "requires", "meticulous"]),
  C2: new Set(["aforementioned", "scrutiny"])
};

const provider = createCEFRDifficultyProvider({ cefrLists });
const difficultyPlugin = createDifficultyPlugin({
  targetLanguage: "en",
  provider
});

const result = await glost()
  .use(difficultyPlugin)
  .process(glostDoc);
```

### Output (Visualized)

**Text 1: "Daily Routine"**
```
I           [Beginner]     Green    â—â—â—â—‹
go          [Beginner]     Green    â—â—â—â—‹
to          [Beginner]     Green    â—â—â—â—‹
school      [Beginner]     Green    â—â—â—â—‹
every       [Beginner]     Green    â—â—â—â—‹
day         [Beginner]     Green    â—â—â—â—‹
study       [Beginner]     Green    â—â—â—â—‹
English     [Beginner]     Green    â—â—â—â—‹
and         [Beginner]     Green    â—â—â—â—‹
math        [Beginner]     Green    â—â—â—â—‹

Overall: 100% beginner words â†’ BEGINNER LEVEL âœ“
```

**Text 2: "Science Paper"**
```
The              [Beginner]      Green     â—â—â—â—‹
implementation   [Intermediate]  Yellow    â—â—â—‹â—‹
of               [Beginner]      Green     â—â—â—â—‹
the              [Beginner]      Green     â—â—â—â—‹
aforementioned   [Advanced]      Red       â—â—‹â—‹â—‹  â† Challenge!
protocol         [Advanced]      Red       â—â—‹â—‹â—‹  â† Challenge!
requires         [Advanced]      Red       â—â—‹â—‹â—‹  â† Challenge!
meticulous       [Advanced]      Red       â—â—‹â—‹â—‹  â† Challenge!
attention        [Intermediate]  Yellow    â—â—â—‹â—‹

Overall: 44% advanced words â†’ ADVANCED LEVEL âš ï¸
```

**Text 3: "News Article"**
```
The             [Beginner]      Green     â—â—â—â—‹
government      [Intermediate]  Yellow    â—â—â—‹â—‹
announced       [Intermediate]  Yellow    â—â—â—‹â—‹
new             [Beginner]      Green     â—â—â—â—‹
regulations     [Intermediate]  Yellow    â—â—â—‹â—‹
for             [Beginner]      Green     â—â—â—â—‹
environmental   [Intermediate]  Yellow    â—â—â—‹â—‹
protection      [Intermediate]  Yellow    â—â—â—‹â—‹

Overall: 63% intermediate words â†’ INTERMEDIATE LEVEL âœ“
```

### UI Implementation

```typescript
function TextDifficultyBadge({ document }) {
  const analysis = analyzeDifficulty(document);
  
  const badges = {
    beginner: { color: "#4CAF50", label: "Beginner Friendly", icon: "ğŸŸ¢" },
    intermediate: { color: "#FF9800", label: "Intermediate", icon: "ğŸŸ¡" },
    advanced: { color: "#F44336", label: "Advanced", icon: "ğŸ”´" }
  };
  
  const badge = badges[analysis.level];
  
  return (
    <div className="difficulty-badge" style={{ backgroundColor: badge.color }}>
      <span className="icon">{badge.icon}</span>
      <span className="label">{badge.label}</span>
      <div className="breakdown">
        <small>
          {analysis.beginner}% beginner | 
          {analysis.intermediate}% intermediate | 
          {analysis.advanced}% advanced
        </small>
      </div>
    </div>
  );
}
```

## Value Demonstrated

### 1. Automatic Text Leveling

```typescript
function levelText(text, wordLists) {
  const words = tokenize(text);
  const difficulties = words.map(w => getDifficulty(w, wordLists));
  
  const counts = {
    beginner: difficulties.filter(d => d === "beginner").length,
    intermediate: difficulties.filter(d => d === "intermediate").length,
    advanced: difficulties.filter(d => d === "advanced").length
  };
  
  const total = words.length;
  const advancedPercent = (counts.advanced / total) * 100;
  
  if (advancedPercent > 30) return "advanced";
  if (advancedPercent > 10 || counts.intermediate > counts.beginner) return "intermediate";
  return "beginner";
}

// Text 1: 0% advanced â†’ "beginner"
// Text 2: 44% advanced â†’ "advanced"
// Text 3: 0% advanced, 63% intermediate â†’ "intermediate"
```

### 2. Personalized Reading Recommendations

```typescript
function recommendTexts(studentLevel, availableTexts) {
  return availableTexts
    .map(text => ({
      ...text,
      difficulty: assessDifficulty(text),
      match: calculateMatch(studentLevel, text.difficulty)
    }))
    .sort((a, b) => b.match - a.match);
}

// Student at "intermediate" level:
// 1. Text 3 (Intermediate) - 100% match âœ“
// 2. Text 1 (Beginner) - 70% match (too easy, but readable)
// 3. Text 2 (Advanced) - 30% match (too hard, frustrating)
```

### 3. Challenge Word Identification

```typescript
function findChallengeWords(document, studentLevel) {
  const words = extractWords(document);
  const challenges = words.filter(word => {
    const difficulty = word.extras?.difficulty?.level;
    
    // Beginner student: intermediate+ is challenging
    if (studentLevel === "beginner") {
      return difficulty === "intermediate" || difficulty === "advanced";
    }
    
    // Intermediate student: only advanced is challenging
    if (studentLevel === "intermediate") {
      return difficulty === "advanced";
    }
    
    return false;
  });
  
  return challenges;
}

// Intermediate student reading Text 2:
// Challenges: ["aforementioned", "protocol", "requires", "meticulous"]
// â†’ Pre-teach these 4 words before reading!
```

## Real Data Example: Japanese (JLPT Levels)

### JLPT Word Lists

```typescript
const jlptLists = {
  N5: new Set(["ç§", "è¡Œã", "å­¦æ ¡", "æ¯æ—¥"]),    // Beginner
  N4: new Set(["å‹‰å¼·", "è‹±èª", "æ•°å­¦", "æ–°ã—ã„"]), // Elementary
  N3: new Set(["æ”¿åºœ", "ç™ºè¡¨", "è¦å‰‡"]),          // Intermediate
  N2: new Set(["ç’°å¢ƒ", "ä¿è­·", "å®Ÿæ–½"]),          // Upper-intermediate
  N1: new Set(["å‰è¿°", "æ–¹å¼", "ç´°å¿ƒ", "æ³¨æ„"])   // Advanced
};

function mapJLPTToDifficulty(jlptLevel) {
  if (jlptLevel === "N5" || jlptLevel === "N4") return "beginner";
  if (jlptLevel === "N3" || jlptLevel === "N2") return "intermediate";
  return "advanced"; // N1
}

const japaneseProvider = createJapaneseDifficultyProvider({ 
  jlptLists,
  mapper: mapJLPTToDifficulty
});
```

### Japanese Text Example

**Text**: "ç§ã¯æ¯æ—¥å­¦æ ¡ã«è¡Œãã¾ã™"  
(I go to school every day)

**Word-by-Word Analysis**:
```
ç§    (I)        N5  â†’ Beginner     [â—â—â—â—‹]
ã¯    (topic)    N5  â†’ Beginner     [â—â—â—â—‹]
æ¯æ—¥  (every day) N5  â†’ Beginner     [â—â—â—â—‹]
å­¦æ ¡  (school)   N5  â†’ Beginner     [â—â—â—â—‹]
ã«    (to)       N5  â†’ Beginner     [â—â—â—â—‹]
è¡Œã  (go)       N5  â†’ Beginner     [â—â—â—â—‹]
ã¾ã™  (polite)   N5  â†’ Beginner     [â—â—â—â—‹]

Overall: 100% N5 words â†’ BEGINNER (JLPT N5 level)
```

## Practical Applications

### 1. Graded Reader Library

```typescript
function buildGradedLibrary(texts) {
  const graded = texts.map(text => ({
    ...text,
    level: assessDifficulty(text),
    words: text.wordCount,
    challenges: countChallengeWords(text)
  }));
  
  return {
    beginner: graded.filter(t => t.level === "beginner"),
    intermediate: graded.filter(t => t.level === "intermediate"),
    advanced: graded.filter(t => t.level === "advanced")
  };
}

// Beginner shelf: 150 texts (0-10 intermediate words each)
// Intermediate shelf: 200 texts (10-30% advanced words)
// Advanced shelf: 100 texts (30%+ advanced vocabulary)
```

### 2. Progress Tracking

```typescript
function trackProgress(student) {
  const readingHistory = student.completedTexts;
  const levels = readingHistory.map(t => t.difficulty);
  
  const timeline = [
    { month: "Jan", level: "beginner", texts: 10 },
    { month: "Feb", level: "beginner", texts: 15 },
    { month: "Mar", level: "intermediate", texts: 5 },  // â† Progress!
    { month: "Apr", level: "intermediate", texts: 12 }
  ];
  
  return {
    currentLevel: "intermediate",
    trend: "improving",
    recommendation: "Continue with intermediate texts, try 1-2 advanced texts per week"
  };
}
```

### 3. Adaptive Difficulty Progression

```typescript
function selectNextText(student, completedText) {
  const currentDifficulty = completedText.difficulty;
  const comprehension = student.lastScore; // e.g., 85%
  
  if (comprehension > 90 && currentDifficulty === "beginner") {
    return findText({ difficulty: "intermediate", first: true });
  }
  
  if (comprehension < 70) {
    return findText({ difficulty: currentDifficulty, easier: true });
  }
  
  return findText({ difficulty: currentDifficulty, similar: true });
}

// Student scored 92% on beginner text â†’ recommend first intermediate text
// Student scored 65% on intermediate text â†’ recommend easier intermediate text
```

## Thai Example: CEFR + Thai-Specific Lists

### Combining Standard and Local Word Lists

```typescript
const thaiDifficultyProvider = createThaiDifficultyProvider({
  cefrLists: standardCEFRLists,         // International words
  thaiSpecific: thaiEducationLists,     // Thai curriculum
  combineStrategy: "union"              // Use both lists
});

// "à¸›à¸£à¸°à¸Šà¸²à¸˜à¸´à¸›à¹„à¸•à¸¢" (democracy) 
// - Not in CEFR (Thai word)
// - In Thai Grade 6 curriculum â†’ Intermediate
```

### Thai Text Example

**Text**: "à¸›à¸£à¸°à¸Šà¸²à¸˜à¸´à¸›à¹„à¸•à¸¢à¹€à¸›à¹‡à¸™à¸£à¸°à¸šà¸šà¸à¸²à¸£à¸›à¸à¸„à¸£à¸­à¸‡à¸—à¸µà¹ˆà¸”à¸µ"  
(Democracy is a good governance system)

**Analysis**:
```
à¸›à¸£à¸°à¸Šà¸²à¸˜à¸´à¸›à¹„à¸•à¸¢ (democracy)     â†’ Intermediate (Grade 6+)  [â—â—â—‹â—‹]
à¹€à¸›à¹‡à¸™      (is)            â†’ Beginner    (Grade 1)   [â—â—â—â—‹]
à¸£à¸°à¸šà¸š      (system)        â†’ Intermediate (Grade 5)   [â—â—â—‹â—‹]
à¸à¸²à¸£à¸›à¸à¸„à¸£à¸­à¸‡ (governance)    â†’ Intermediate (Grade 7)   [â—â—â—‹â—‹]
à¸—à¸µà¹ˆ        (that)          â†’ Beginner    (Grade 1)   [â—â—â—â—‹]
à¸”à¸µ        (good)          â†’ Beginner    (Grade 1)   [â—â—â—â—‹]

Overall: 50% intermediate vocabulary â†’ INTERMEDIATE LEVEL
```

## Integration Example: Complete Adaptive System

```typescript
import { glost } from "glost";
import { createDifficultyPlugin } from "glost-difficulty";

// 1. Load difficulty data (CEFR, JLPT, or custom)
const wordLists = await loadCEFRWordLists();
const provider = createDifficultyProvider({ wordLists });

// 2. Create and freeze processor for reuse
const processor = glost()
  .use(createDifficultyPlugin({
    targetLanguage: "en",
    provider
  }))
  .freeze();

// 3. Process library
async function processTextLibrary(texts) {
  const processed = [];

  for (const text of texts) {
    const glostDoc = convertTextToGLOST(text.content, "en");
    const result = await processor.process(glostDoc);

    processed.push({
      ...text,
      difficulty: assessOverallDifficulty(result.document),
      challengeWords: extractChallengeWords(result.document),
      suitableFor: determineSuitability(result.document)
    });
  }

  return processed;
}

// 4. Render adaptive UI
function AdaptiveLibrary({ texts, studentLevel }) {
  const suitable = texts.filter(t =>
    t.suitableFor.includes(studentLevel)
  );

  return (
    <div className="library">
      <h2>Recommended for {studentLevel} level</h2>
      {suitable.map(text => (
        <TextCard
          key={text.id}
          {...text}
          highlighted={text.difficulty === studentLevel}
        />
      ))}
    </div>
  );
}
```

## Conclusion

Difficulty assessment transforms your content library from **ungraded materials** into a **structured learning path**:

- âœ… Students read at their level (90% comprehension â†’ optimal learning)
- âœ… Progress is measurable (beginner â†’ intermediate â†’ advanced)
- âœ… Frustration reduced (no texts too hard or too boring)
- âœ… Challenge words pre-taught (targeted vocabulary instruction)

**The key**: Validated word lists (CEFR, JLPT, HSK, curriculum standards), not length-based guesses.
